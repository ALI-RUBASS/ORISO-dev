apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "tenantservice.fullname" . }}-config
  namespace: {{ .Values.namespace }}
  labels:
    {{- include "tenantservice.labels" . | nindent 4 }}
data:
  # Database Configuration - Use full Kubernetes DNS FQDN (required for managed clusters)
  SPRING_DATASOURCE_URL: {{ .Values.database.url | quote }}
  
  # Keycloak Configuration - Use full Kubernetes DNS FQDN (required for managed clusters)
  KEYCLOAK_AUTH_SERVER_URL: {{ .Values.keycloak.authServerUrl | quote }}
  KEYCLOAK_REALM: {{ .Values.keycloak.realm | quote }}
  SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_ISSUER_URI: {{ .Values.keycloak.jwt.issuerUri | quote }}
  SPRING_SECURITY_OAUTH2_RESOURCESERVER_JWT_JWK_SET_URI: {{ .Values.keycloak.jwt.jwkSetUri | quote }}
  
  # RabbitMQ Configuration - Use full Kubernetes DNS FQDN (required for managed clusters)
  SPRING_RABBITMQ_HOST: {{ .Values.rabbitmq.host | quote }}
  SPRING_RABBITMQ_PORT: {{ .Values.rabbitmq.port | quote }}
  SPRING_RABBITMQ_USERNAME: {{ .Values.rabbitmq.username | quote }}
  SPRING_RABBITMQ_PASSWORD: {{ .Values.rabbitmq.password | quote }}
  
  # Service URLs - Use full Kubernetes DNS FQDN (required for managed clusters)
  CONSULTING_TYPE_SERVICE_API_URL: {{ .Values.services.consultingTypeService.apiUrl | quote }}
  USER_SERVICE_API_URL: {{ .Values.services.userService.apiUrl | quote }}
  
  # Spring Profile
  SPRING_PROFILES_ACTIVE: {{ .Values.spring.profiles.active | quote }}
  
  # Feature Flags
  FEATURE_MULTITENANCY_WITH_SINGLE_DOMAIN_ENABLED: {{ .Values.features.multitenancy.withSingleDomain.enabled | quote }}
  
  # Liquibase - Explicitly disabled (database schemas managed separately in ORISO-Database)
  SPRING_LIQUIBASE_ENABLED: {{ .Values.database.liquibase.enabled | quote }}


